<!-- NetOpenX Makaleleri için özel TOC -->
{% if page.categories contains 'netopenx' and page.toc %}
<div class="container">
    <div class="row">
        <div class="col-12">
            <div class="toc">
                <h4>📋 İçindekiler</h4>
                <ul id="toc-list">
                    <!-- JavaScript ile dinamik olarak doldurulacak -->
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocList = document.getElementById('toc-list');
    const headings = document.querySelectorAll('.article-post h2, .article-post h3, .article-post h4');
    
    if (headings.length === 0) return;
    
    headings.forEach((heading, index) => {
        // Gereksiz başlıkları filtrele
        const headingText = heading.textContent.trim().toLowerCase();
        const skipHeadings = ['summary', 'özet', 'table of contents', 'içindekiler'];
        
        if (skipHeadings.some(skip => headingText.includes(skip))) {
            return; // Bu başlığı atla
        }
        
        // ID ekle
        const id = `heading-${index}`;
        heading.id = id;
        
        // TOC item oluştur
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = `#${id}`;
        a.className = `toc-${heading.tagName.toLowerCase()}`;
        
        // İkon ekle
        const icon = getIconForHeading(heading.textContent);
        if (icon) {
            a.innerHTML = `${icon} ${heading.textContent}`;
        } else {
            a.textContent = heading.textContent;
        }
        
        li.appendChild(a);
        tocList.appendChild(li);
    });
    
    // Smooth scroll
    document.querySelectorAll('.toc a').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
});

function getIconForHeading(text) {
    const lowerText = text.toLowerCase();
    if (lowerText.includes('giriş') || lowerText.includes('başlangıç')) return '🚀';
    if (lowerText.includes('genel') || lowerText.includes('bakış')) return '📋';
    if (lowerText.includes('kurulum') || lowerText.includes('setup')) return '⚙️';
    if (lowerText.includes('bağlantı') || lowerText.includes('connection')) return '🔗';
    if (lowerText.includes('fatura') || lowerText.includes('invoice')) return '📄';
    if (lowerText.includes('kod') || lowerText.includes('örnek')) return '💻';
    if (lowerText.includes('kalem') || lowerText.includes('item')) return '📝';
    if (lowerText.includes('hata') || lowerText.includes('error')) return '❌';
    if (lowerText.includes('önemli') || lowerText.includes('dikkat')) return '⚠️';
    if (lowerText.includes('notlar') || lowerText.includes('bilgi')) return '📝';
    return '▶️';
}
</script>

<style>
.toc-h3 { padding-left: 1rem; }
.toc-h4 { padding-left: 2rem; font-size: 0.9em; }
</style>
{% endif %}